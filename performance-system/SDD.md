# 团队人员绩效系统 - 软件设计文档 (SDD)

## 1. 系统概述
团队人员绩效系统是一个用于管理团队成员季度绩效评估的Web应用。系统支持三种角色：管理员、项目经理(PM)和普通用户(user)，提供人员管理、绩效评估、历史记录查看和邮件通知功能。

## 2. 功能需求

### 2.1 人员管理
- **角色类型**: 管理员、PM、普通user
- **用户属性**: 
  - 工号 (employee_id) - 唯一标识
  - 邮箱 (email) - 用于登录和邮件通知
  - 姓名 (name) - 显示名称
- **关系管理**: 每个user可以属于一个或多个PM

### 2.2 季度绩效管理
- **绩效周期**: 按季度进行（Q1, Q2, Q3, Q4 + 年份）
- **评估权限**: 只有PM可以评估其下属user
- **评估内容**:
  - 考核等级: A/B/C/D 四档（必填）
  - 评语: 文本输入（必填）
- **查看权限**: 
  - PM: 查看自己下属的所有历史绩效
  - 管理员: 查看所有用户的全部历史绩效

### 2.3 邮件通知
- **触发条件**: 管理员确认所有绩效数据无误后
- **邮件内容**: 包含PM的考核等级和评语
- **发送方式**: 调用Python脚本批量发送

## 3. 非功能需求

### 3.1 安全性
- 用户认证和授权
- 数据隐私保护
- 防止未授权访问

### 3.2 可用性
- 响应式Web界面
- 直观的用户操作流程
- 错误处理和用户反馈

### 3.3 可维护性
- 模块化代码结构
- 清晰的文档
- 易于扩展和修改

## 4. 技术架构

### 4.1 技术栈选择
- **后端**: Python Flask (轻量级，易于开发)
- **前端**: HTML/CSS/JavaScript (简单直接)
- **数据库**: SQLite (轻量级，无需额外配置)
- **邮件**: smtplib (Python内置)

### 4.2 系统架构
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Web Browser   │───▶│     Flask       │───▶│    SQLite       │
│    (Frontend)   │    │    (Backend)    │    │    (Database)   │
└─────────────────┘    └─────────────────┘    └─────────────────┘
                                │
                                ▼
                        ┌─────────────────┐
                        │   Email SMTP    │
                        │   (smtplib)     │
                        └─────────────────┘
```

## 5. 数据模型

### 5.1 用户表 (users)
| 字段 | 类型 | 描述 |
|------|------|------|
| id | INTEGER PRIMARY KEY | 用户ID |
| employee_id | TEXT UNIQUE | 工号 |
| email | TEXT UNIQUE | 邮箱 |
| name | TEXT | 姓名 |
| role | TEXT | 角色 ('admin', 'pm', 'user') |

### 5.2 用户-PM关系表 (user_pm_relations)
| 字段 | 类型 | 描述 |
|------|------|------|
| user_id | INTEGER | 用户ID (外键) |
| pm_id | INTEGER | PM ID (外键) |

### 5.3 绩效评估表 (performance_reviews)
| 字段 | 类型 | 描述 |
|------|------|------|
| id | INTEGER PRIMARY KEY | 评估ID |
| user_id | INTEGER | 被评估用户ID |
| pm_id | INTEGER | 评估PM ID |
| quarter | TEXT | 季度 (如 "2026-Q1") |
| grade | TEXT | 考核等级 (A/B/C/D) |
| comment | TEXT | 评语 |
| created_at | DATETIME | 创建时间 |
| confirmed | BOOLEAN | 是否已确认 |

## 6. API接口设计

### 6.1 用户管理API
- `GET /api/users` - 获取用户列表
- `POST /api/users` - 创建新用户
- `GET /api/users/{id}` - 获取用户详情

### 6.2 绩效管理API
- `GET /api/reviews` - 获取绩效列表
- `POST /api/reviews` - 创建绩效评估
- `PUT /api/reviews/{id}/confirm` - 确认绩效数据

### 6.3 邮件发送API
- `POST /api/send-emails` - 发送绩效邮件

## 7. 用户界面设计

### 7.1 登录页面
- 邮箱和密码输入
- 角色自动识别

### 7.2 PM工作台
- 下属用户列表
- 绩效评估表单
- 历史记录查看

### 7.3 管理员面板
- 所有用户管理
- 全部绩效记录
- 邮件发送按钮

## 8. 开发任务分解

### 8.1 第一阶段：基础架构
- [ ] 项目初始化
- [ ] 数据库设计和实现
- [ ] 用户认证系统

### 8.2 第二阶段：核心功能
- [ ] 人员管理功能
- [ ] 绩效评估功能
- [ ] 历史记录查看

### 8.3 第三阶段：邮件系统
- [ ] 邮件模板设计
- [ ] 邮件发送脚本
- [ ] 管理员确认流程

### 8.4 第四阶段：测试和部署
- [ ] 功能测试
- [ ] 用户界面优化
- [ ] 文档编写

## 9. 测试策略

### 9.1 单元测试
- 用户管理模块
- 绩效评估逻辑
- 邮件发送功能

### 9.2 集成测试
- 用户认证流程
- 权限控制验证
- 端到端业务流程

## 10. 部署说明

### 10.1 环境要求
- Python 3.8+
- pip包管理器
- SQLite (内置)

### 10.2 安装步骤
```bash
pip install -r requirements.txt
python app.py
```

### 10.3 配置文件
- `.env` - 邮件服务器配置
- `config.py` - 应用配置

---
**文档版本**: 1.0  
**最后更新**: 2026-02-11  
**作者**: 哈罗助手